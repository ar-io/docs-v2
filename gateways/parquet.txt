1:"$Sreact.fragment"
2:I[60881,["9268","static/chunks/aaea2bcf-432631bb317559fe.js","3975","static/chunks/3975-65073ecd7686b488.js","5227","static/chunks/5227-c718075fe01526db.js","3758","static/chunks/3758-69daa9d9751a2510.js","7066","static/chunks/7066-9ea237f8271c6a3e.js","7948","static/chunks/7948-fe33dfc7f94c2ca6.js","7177","static/chunks/app/layout-5b3aad0cb4b62dbf.js"],"Providers"]
3:I[41056,["9268","static/chunks/aaea2bcf-432631bb317559fe.js","3975","static/chunks/3975-65073ecd7686b488.js","5227","static/chunks/5227-c718075fe01526db.js","3758","static/chunks/3758-69daa9d9751a2510.js","7066","static/chunks/7066-9ea237f8271c6a3e.js","7948","static/chunks/7948-fe33dfc7f94c2ca6.js","7177","static/chunks/app/layout-5b3aad0cb4b62dbf.js"],"Layout"]
4:I[87555,[],""]
5:I[31295,[],""]
6:I[30122,["3975","static/chunks/3975-65073ecd7686b488.js","4345","static/chunks/app/not-found-28cf6d37da7270ee.js"],"default"]
7:I[87254,["9268","static/chunks/aaea2bcf-432631bb317559fe.js","3975","static/chunks/3975-65073ecd7686b488.js","5227","static/chunks/5227-c718075fe01526db.js","6493","static/chunks/6493-a59dcbabb32c712c.js","465","static/chunks/465-50ec6cceb8e1110d.js","5335","static/chunks/app/gateways/parquet/page-fee4a01503c7d981.js"],"Heading"]
8:I[60445,["9268","static/chunks/aaea2bcf-432631bb317559fe.js","3975","static/chunks/3975-65073ecd7686b488.js","5227","static/chunks/5227-c718075fe01526db.js","6493","static/chunks/6493-a59dcbabb32c712c.js","465","static/chunks/465-50ec6cceb8e1110d.js","5335","static/chunks/app/gateways/parquet/page-fee4a01503c7d981.js"],"default"]
9:I[81571,["9268","static/chunks/aaea2bcf-432631bb317559fe.js","3975","static/chunks/3975-65073ecd7686b488.js","5227","static/chunks/5227-c718075fe01526db.js","6493","static/chunks/6493-a59dcbabb32c712c.js","465","static/chunks/465-50ec6cceb8e1110d.js","5335","static/chunks/app/gateways/parquet/page-fee4a01503c7d981.js"],"Pre"]
a:I[81571,["9268","static/chunks/aaea2bcf-432631bb317559fe.js","3975","static/chunks/3975-65073ecd7686b488.js","5227","static/chunks/5227-c718075fe01526db.js","6493","static/chunks/6493-a59dcbabb32c712c.js","465","static/chunks/465-50ec6cceb8e1110d.js","5335","static/chunks/app/gateways/parquet/page-fee4a01503c7d981.js"],"Code"]
f:I[73019,["9268","static/chunks/aaea2bcf-432631bb317559fe.js","3975","static/chunks/3975-65073ecd7686b488.js","5227","static/chunks/5227-c718075fe01526db.js","6493","static/chunks/6493-a59dcbabb32c712c.js","465","static/chunks/465-50ec6cceb8e1110d.js","5335","static/chunks/app/gateways/parquet/page-fee4a01503c7d981.js"],"Feedback"]
10:I[59665,[],"OutletBoundary"]
13:I[74911,[],"AsyncMetadataOutlet"]
15:I[59665,[],"ViewportBoundary"]
17:I[59665,[],"MetadataBoundary"]
19:I[26614,[],""]
:HL["/docs-v2/_next/static/css/79a0b2a497090510.css","style"]
b:Tde1,<span><span style="color: var(--shiki-token-function)">sudo</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string)">apt-get</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string)">install</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string)">-y</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string)">apt-transport-https</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string)">ca-certificates</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string)">curl</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string)">gnupg</span></span>
<span><span style="color: var(--shiki-token-function)">curl</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string)">-fsSL</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&#39;https://packages.clickhouse.com/rpm/lts/repodata/repomd.xml.key&#39;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">|</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">sudo</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string)">gpg</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string)">--dearmor</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string)">-o</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string)">/usr/share/keyrings/clickhouse-keyring.gpg</span></span>
<span></span>
<span><span style="color: var(--shiki-color-text)">ARCH</span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-token-string-expression)">$(</span><span style="color: var(--shiki-token-function)">dpkg</span><span style="color: var(--shiki-token-string-expression)"> </span><span style="color: var(--shiki-token-string)">--print-architecture</span><span style="color: var(--shiki-token-string-expression)">)</span></span>
<span><span style="color: var(--shiki-token-function)">echo</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&quot;deb [signed-by=/usr/share/keyrings/clickhouse-keyring.gpg arch=${ARCH}] https://packages.clickhouse.com/deb stable main&quot;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">|</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">sudo</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string)">tee</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string)">/etc/apt/sources.list.d/clickhouse.list</span></span>
<span><span style="color: var(--shiki-token-function)">sudo</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string)">apt-get</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string)">update</span></span>
<span></span>c:T617,<span><span style="color: var(--shiki-color-text)">ANS104_UNBUNDLE_FILTER</span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-token-string-expression)">&#39;{ &quot;and&quot;: [ { &quot;not&quot;: { &quot;or&quot;: [ { &quot;tags&quot;: [ { &quot;name&quot;: &quot;Bundler-App-Name&quot;, &quot;value&quot;: &quot;Warp&quot; } ] }, { &quot;tags&quot;: [ { &quot;name&quot;: &quot;Bundler-App-Name&quot;, &quot;value&quot;: &quot;Redstone&quot; } ] }, { &quot;tags&quot;: [ { &quot;name&quot;: &quot;Bundler-App-Name&quot;, &quot;value&quot;: &quot;KYVE&quot; } ] }, { &quot;tags&quot;: [ { &quot;name&quot;: &quot;Bundler-App-Name&quot;, &quot;value&quot;: &quot;AO&quot; } ] }, { &quot;attributes&quot;: { &quot;owner_address&quot;: &quot;-OXcT1sVRSA5eGwt2k6Yuz8-3e3g9WJi5uSE99CWqsBs&quot; } }, { &quot;attributes&quot;: { &quot;owner_address&quot;: &quot;ZE0N-8P9gXkhtK-07PQu9d8me5tGDxa_i4Mee5RzVYg&quot; } }, { &quot;attributes&quot;: { &quot;owner_address&quot;: &quot;6DTqSgzXVErOuLhaP0fmAjqF4yzXkvth58asTxP3pNw&quot; } } ] } }, { &quot;tags&quot;: [ { &quot;name&quot;: &quot;App-Name&quot;, &quot;valueStartsWith&quot;: &quot;ArDrive&quot; } ] } ] }&#39;</span></span>
<span><span style="color: var(--shiki-color-text)">ANS104_INDEX_FILTER</span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-token-string-expression)">&#39;{ &quot;tags&quot;: [ { &quot;name&quot;: &quot;App-Name&quot;, &quot;value&quot;: &quot;ArDrive-App&quot; } ] }&#39;</span></span>
<span></span>d:T45e,<span><span style="color: var(--shiki-token-function)">clickhouse</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string)">client</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string)">--password</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">&lt;</span><span style="color: var(--shiki-token-string)">your-passwor</span><span style="color: var(--shiki-color-text)">d</span><span style="color: var(--shiki-token-keyword)">&gt;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string)">-h</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string)">localhost</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string)">-q</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&#39;SELECT COUNT(DISTINCT id) FROM transactions&#39;</span></span>
<span></span>e:T734,<span><span style="color: var(--shiki-token-function)">curl</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string)">-g</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string)">-X</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string)">POST</span><span style="color: var(--shiki-color-text)"> \</span></span>
<span><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-string)">-H</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&quot;Content-Type: application/json&quot;</span><span style="color: var(--shiki-color-text)"> \</span></span>
<span><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-string)">-d</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&#39;{&quot;query&quot;:&quot;query { transactions(ids: [\&quot;YSNwoYB01EFIzbs6HmkGUjjxHW3xuqh-rckYhi0av4A\&quot;]) { edges { node { block { height } bundledIn { id } } } } }&quot;}&#39;</span><span style="color: var(--shiki-color-text)"> \</span></span>
<span><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-string)">http://localhost:3000/graphql</span></span>
<span></span>
<span><span style="color: var(--shiki-token-comment)"># Expected output:</span></span>
<span><span style="color: var(--shiki-token-comment)"># {&quot;data&quot;:{&quot;transactions&quot;:{&quot;edges&quot;:[{&quot;node&quot;:{&quot;block&quot;:{&quot;height&quot;:1461918},&quot;bundledIn&quot;:{&quot;id&quot;:&quot;ylhb0PqDtG5HwBg00_RYztUl0x2RuKvbNzT6YiNR2JA&quot;}}}]}}}</span></span>
<span></span>0:{"P":null,"b":"YBVYu160nkt5YyI0SWlvP","p":"/docs-v2","c":["","gateways","parquet"],"i":false,"f":[[["",{"children":["gateways",{"children":["parquet",{"children":["__PAGE__",{}]}]}]},"$undefined","$undefined",true],["",["$","$1","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/docs-v2/_next/static/css/79a0b2a497090510.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","html",null,{"lang":"en","className":"h-full","suppressHydrationWarning":true,"children":["$","body",null,{"className":"flex min-h-full bg-white antialiased dark:bg-zinc-900","children":["$","$L2",null,{"children":["$","$L3",null,{"children":["$","$L4",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[["$","$L6",null,{}],[]],"forbidden":"$undefined","unauthorized":"$undefined"}]}]}]}]}]]}],{"children":["gateways",["$","$1","c",{"children":[null,["$","$L4",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":["parquet",["$","$1","c",{"children":[null,["$","$L4",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":["__PAGE__",["$","$1","c",{"children":[["$","article",null,{"className":"flex h-full w-full flex-col pb-10 pt-16","children":[["$","div",null,{"className":"flex-auto prose w-full dark:prose-invert","children":[["$","h1",null,{"children":"Parquet and ClickHouse Usage Guide"}],"\n",["$","$L7",null,{"level":2,"id":"overview","children":"Overview"}],"\n",["$","p",null,{"children":"AR.IO gateway Release 33 introduces a new configuration option for using Parquet files and ClickHouse to improve performance and scalability of your AR.IO gateway for large datasets."}],"\n",["$","p",null,{"children":"This guide will walk you through the process of setting up ClickHouse with your AR.IO gateway, and importing Parquet files to bootstrap your ClickHouse database."}],"\n",["$","$L7",null,{"level":2,"id":"what-is-parquet","children":"What is Parquet?"}],"\n",["$","p",null,{"children":"Apache Parquet is a columnar storage file format designed for efficient data storage and retrieval. Unlike row-based storage formats like SQLite, Parquet organizes data by column rather than by row, which provides several advantages for analytical workloads:"}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":[["$","strong",null,{"children":"Efficient compression"}],": Similar data is stored together, leading to better compression ratios"]}],"\n",["$","li",null,{"children":[["$","strong",null,{"children":"Columnar access"}],": You can read only the columns you need, reducing I/O operations"]}],"\n",["$","li",null,{"children":[["$","strong",null,{"children":"Predicate pushdown"}],": Filter operations can be pushed down to the storage layer, improving query performance"]}],"\n"]}],"\n",["$","$L7",null,{"level":2,"id":"current-integration-with-ar-io-gateways","children":"Current Integration with AR.IO Gateways"}],"\n",["$","p",null,{"children":"In the current AR.IO gateway implementation, Parquet and ClickHouse run alongside SQLite rather than replacing it. This parallel architecture allows each database to handle what it does best:"}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":[["$","strong",null,{"children":"SQLite"}]," continues to handle transaction writes and updates"]}],"\n",["$","li",null,{"children":[["$","strong",null,{"children":"ClickHouse"}]," with Parquet files is optimized for fast query performance, especially with large datasets"]}],"\n"]}],"\n",["$","p",null,{"children":"The gateway continues to operate with SQLite just as it always has, maintaining all of its normal functionality. Periodically, the gateway will export batches of data from SQLite to Parquet files, which are then imported into ClickHouse. This batch-oriented approach is much more efficient than attempting to synchronize the databases in real-time, as it leverages Parquet's strength in handling large, immutable data sets."}],"\n",["$","p",null,{"children":"Note that despite Parquet's efficient compression, gateways may not see significant disk space reduction in all cases. While bundled transaction data is exported to Parquet, L1 data remains in SQLite. Without substantial unbundling and indexing filters, minimal data gets exported to Parquet, limiting potential storage savings."}],"\n",["$","p",null,{"children":"With ClickHouse integration enabled, GraphQL queries are primarily routed to ClickHouse, leveraging its superior performance for large datasets. This significantly improves response times while maintaining SQLite's reliability for transaction processing."}],"\n",["$","$L7",null,{"level":2,"id":"parquet-vs-sq-lite-in-ar-io-gateways","children":"Parquet vs. SQLite in AR.IO Gateways"}],"\n",["$","p",null,{"children":"While SQLite is excellent for transactional workloads and small to medium datasets, it faces challenges with very large datasets:"}],"\n",["$","div",null,{"className":"my-6 flex w-full justify-center","style":"$undefined","children":["$","table",null,{"className":"inline-table","style":"$undefined","children":[["$","thead",null,{"className":"$undefined","children":["$","tr",null,{"className":"$undefined","children":[["$","th",null,{"className":"$undefined","children":"Feature"}],["$","th",null,{"className":"$undefined","children":"SQLite"}],["$","th",null,{"className":"$undefined","children":"Parquet + ClickHouse"}]]}]}],["$","tbody",null,{"className":"$undefined","children":[["$","tr",null,{"className":"$undefined","children":[["$","td",null,{"className":"$undefined","children":"Storage model"}],["$","td",null,{"className":"$undefined","children":"Row-based"}],["$","td",null,{"className":"$undefined","children":"Column-based"}]]}],["$","tr",null,{"className":"$undefined","children":[["$","td",null,{"className":"$undefined","children":"Query optimization"}],["$","td",null,{"className":"$undefined","children":"Basic"}],["$","td",null,{"className":"$undefined","children":"Advanced analytical optimization"}]]}],["$","tr",null,{"className":"$undefined","children":[["$","td",null,{"className":"$undefined","children":"Compression"}],["$","td",null,{"className":"$undefined","children":"Limited"}],["$","td",null,{"className":"$undefined","children":"High compression ratios"}]]}],["$","tr",null,{"className":"$undefined","children":[["$","td",null,{"className":"$undefined","children":"Scaling"}],["$","td",null,{"className":"$undefined","children":"Limited by single file"}],["$","td",null,{"className":"$undefined","children":"Distributed processing capable"}]]}],["$","tr",null,{"className":"$undefined","children":[["$","td",null,{"className":"$undefined","children":"Write speed"}],["$","td",null,{"className":"$undefined","children":"Fast for small transactions"}],["$","td",null,{"className":"$undefined","children":"Optimized for batch operations"}]]}],["$","tr",null,{"className":"$undefined","children":[["$","td",null,{"className":"$undefined","children":"Read speed for analytics"}],["$","td",null,{"className":"$undefined","children":"Slower for large datasets"}],["$","td",null,{"className":"$undefined","children":"Optimized for analytical queries"}]]}],["$","tr",null,{"className":"$undefined","children":[["$","td",null,{"className":"$undefined","children":"Ideal use case"}],["$","td",null,{"className":"$undefined","children":"Recent transaction data, OLTP"}],["$","td",null,{"className":"$undefined","children":"Historical data, OLAP workloads"}]]}]]}]]}]}],"\n",["$","$L7",null,{"level":2,"id":"benefits-for-gateway-operators","children":"Benefits for Gateway Operators"}],"\n",["$","p",null,{"children":"Implementing Parquet and ClickHouse alongside SQLite in your AR.IO gateway offers several key advantages:"}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":[["$","strong",null,{"children":"Dramatically improved query performance"}]," for GraphQL endpoints, especially for large result sets"]}],"\n",["$","li",null,{"children":[["$","strong",null,{"children":"Reduced storage requirements"}]," through efficient columnar compression"]}],"\n",["$","li",null,{"children":[["$","strong",null,{"children":"Better scalability"}]," for growing datasets"]}],"\n",["$","li",null,{"children":[["$","strong",null,{"children":"Faster bootstrapping"}]," of new gateways through Parquet file imports"]}],"\n",["$","li",null,{"children":[["$","strong",null,{"children":"Reduced load on SQLite"}]," by offloading query operations to ClickHouse"]}],"\n"]}],"\n",["$","p",null,{"children":"The primary focus of the Parquet/ClickHouse integration is the significant speed improvement for querying large datasets. Gateway operators managing significant volumes of data will notice substantial performance gains when using this configuration."}],"\n",["$","$L7",null,{"level":2,"id":"storage-considerations","children":"Storage Considerations"}],"\n",["$","p",null,{"children":"While Parquet files offer more efficient compression for the data they contain, it's important to understand the storage impact:"}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":"Bundled transaction data is exported to Parquet and removed from SQLite, potentially saving space"}],"\n",["$","li",null,{"children":"L1 data remains in SQLite regardless of Parquet configuration"}],"\n",["$","li",null,{"children":"Space savings are highly dependent on your unbundling filters - without substantial unbundling configurations, minimal data gets exported to Parquet"}],"\n",["$","li",null,{"children":"The more data you unbundle and export to Parquet, the greater the potential storage efficiency"}],"\n"]}],"\n",["$","p",null,{"children":"For gateway operators, this means proper filter configuration is crucial to realize storage benefits. The primary advantage remains significantly improved query performance for large datasets, with potential space savings as a secondary benefit depending on your specific configuration."}],"\n",["$","p",null,{"children":"The following sections will guide you through setting up ClickHouse with your AR.IO gateway, exporting data from SQLite to Parquet, and importing Parquet files to bootstrap your ClickHouse database."}],"\n",["$","div",null,{"className":"border-l-4 border-orange-500 bg-gray-800 text-white p-4 rounded-md","children":[["$","div",null,{"className":"font-semibold text-lg text-orange-300 mb-2","children":"Note"}],["$","div",null,{"className":"text-sm","children":[["$","p",null,{"children":"The below instructions are designed to be used in a linux environment. Windows and MacOS users must modify the instructions to use the appropriate package manager/ command syntax for their platform."}],["$","p",null,{"children":"Unless otherwise specified, all commands should be run from the root directory of the gateway."}]]}]]}],"\n",["$","$L7",null,{"level":2,"id":"installing-click-house","children":"Installing ClickHouse"}],"\n",["$","p",null,{"children":"ClickHouse is a powerful, open-source analytical database that excels at handling large datasets and complex queries. It is the tool used by the gateway to integrate with the Parquet format. To integrate ClickHouse with your AR.IO gateway, follow these steps:"}],"\n",["$","p",null,{"children":["It is recommended to use ",["$","$L8",null,{"href":"https://clickhouse.com/docs/install#quick-install","children":"official pre-compiled deb packages for Debian or Ubuntu"}],". Run these commands to install packages:"]}],"\n",["$","$L9",null,{"language":"bash","code":"sudo apt-get install -y apt-transport-https ca-certificates curl gnupg\ncurl -fsSL 'https://packages.clickhouse.com/rpm/lts/repodata/repomd.xml.key' | sudo gpg --dearmor -o /usr/share/keyrings/clickhouse-keyring.gpg\n\nARCH=$(dpkg --print-architecture)\necho \"deb [signed-by=/usr/share/keyrings/clickhouse-keyring.gpg arch=${ARCH}] https://packages.clickhouse.com/deb stable main\" | sudo tee /etc/apt/sources.list.d/clickhouse.list\nsudo apt-get update\n","children":["$","$La",null,{"className":"language-bash","children":"$b"}]}],"\n",["$","p",null,{"language":"txt","children":["This will verify the installation package from official sources and enable installation via ",["$","$La",null,{"children":"apt-get"}],"."]}],"\n",["$","$L9",null,{"language":"bash","code":"sudo apt-get install -y clickhouse-client\n","children":["$","$La",null,{"className":"language-bash","children":"<span><span style=\"color: var(--shiki-token-function)\">sudo</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">apt-get</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">install</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">-y</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">clickhouse-client</span></span>\n<span></span>"}]}],"\n",["$","p",null,{"children":"This will perform the actual installation of the ClickHouse server and client."}],"\n",["$","p",null,{"language":"txt","children":["During installation, you will be prompted to set a password for the ",["$","$La",null,{"children":"default"}]," user. This is required to connect to the ClickHouse server."]}],"\n",["$","p",null,{"language":"txt","children":["Advanced users may also choose to create a designated user account in clickhouse for the gateway to use, but the default gateway configuration will assume the ",["$","$La",null,{"children":"default"}]," user."]}],"\n",["$","$L7",null,{"level":2,"id":"configure-gateway-to-use-click-house","children":"Configure Gateway to use ClickHouse"}],"\n",["$","p",null,{"language":"txt","children":["Because the gateway will be accessing ClickHouse, host address andthe password for the selected user must be provided. This is done via the ",["$","$La",null,{"children":"CLICKHOUSE_PASSWORD"}]," environment variable."]}],"\n",["$","p",null,{"children":"Update your .env file with the following:"}],"\n",["$","$L9",null,{"language":"bash","code":"CLICKHOUSE_URL=\"http://clickhouse:8123\"\nCLICKHOUSE_PASSWORD=<your-password>\n","children":["$","$La",null,{"className":"language-bash","children":"<span><span style=\"color: var(--shiki-color-text)\">CLICKHOUSE_URL</span><span style=\"color: var(--shiki-token-keyword)\">=</span><span style=\"color: var(--shiki-token-string-expression)\">&quot;http://clickhouse:8123&quot;</span></span>\n<span><span style=\"color: var(--shiki-color-text)\">CLICKHOUSE_PASSWORD</span><span style=\"color: var(--shiki-token-keyword)\">=&lt;</span><span style=\"color: var(--shiki-token-string)\">your-passwor</span><span style=\"color: var(--shiki-color-text)\">d</span><span style=\"color: var(--shiki-token-keyword)\">&gt;</span></span>\n<span></span>"}]}],"\n",["$","p",null,{"language":"txt","children":["If you set a specific user account for the gateway to use, you can set the ",["$","$La",null,{"children":"CLICKHOUSE_USER"}]," environment variable to the username."]}],"\n",["$","$L9",null,{"language":"bash","code":"CLICKHOUSE_USER=<your-username>\n","children":["$","$La",null,{"className":"language-bash","children":"<span><span style=\"color: var(--shiki-color-text)\">CLICKHOUSE_USER</span><span style=\"color: var(--shiki-token-keyword)\">=&lt;</span><span style=\"color: var(--shiki-token-string)\">your-usernam</span><span style=\"color: var(--shiki-color-text)\">e</span><span style=\"color: var(--shiki-token-keyword)\">&gt;</span></span>\n<span></span>"}]}],"\n",["$","p",null,{"language":"txt","children":["If omitted, the gateway will use the ",["$","$La",null,{"children":"default"}]," user."]}],"\n",["$","p",null,{"children":"Additionally, The Parquet file provided below contains an unbundled data set that includes all data items uploaded via an ArDrive product, including Turbo. Because of this, it is recommended to include unbundling filters that match, or expand, this configuration."}],"\n",["$","$L9",null,{"language":"bash","code":"ANS104_UNBUNDLE_FILTER='{ \"and\": [ { \"not\": { \"or\": [ { \"tags\": [ { \"name\": \"Bundler-App-Name\", \"value\": \"Warp\" } ] }, { \"tags\": [ { \"name\": \"Bundler-App-Name\", \"value\": \"Redstone\" } ] }, { \"tags\": [ { \"name\": \"Bundler-App-Name\", \"value\": \"KYVE\" } ] }, { \"tags\": [ { \"name\": \"Bundler-App-Name\", \"value\": \"AO\" } ] }, { \"attributes\": { \"owner_address\": \"-OXcT1sVRSA5eGwt2k6Yuz8-3e3g9WJi5uSE99CWqsBs\" } }, { \"attributes\": { \"owner_address\": \"ZE0N-8P9gXkhtK-07PQu9d8me5tGDxa_i4Mee5RzVYg\" } }, { \"attributes\": { \"owner_address\": \"6DTqSgzXVErOuLhaP0fmAjqF4yzXkvth58asTxP3pNw\" } } ] } }, { \"tags\": [ { \"name\": \"App-Name\", \"valueStartsWith\": \"ArDrive\" } ] } ] }'\nANS104_INDEX_FILTER='{ \"tags\": [ { \"name\": \"App-Name\", \"value\": \"ArDrive-App\" } ] }'\n","children":["$","$La",null,{"className":"language-bash","children":"$c"}]}],"\n",["$","p",null,{"children":"Lastly, you must have a gateway admin password set. This is used for the periodic export of data from SQLite to Parquet."}],"\n",["$","$L9",null,{"language":"bash","code":"ADMIN_API_KEY=<example>\n","children":["$","$La",null,{"className":"language-bash","children":"<span><span style=\"color: var(--shiki-color-text)\">ADMIN_API_KEY</span><span style=\"color: var(--shiki-token-keyword)\">=&lt;</span><span style=\"color: var(--shiki-token-string)\">exampl</span><span style=\"color: var(--shiki-color-text)\">e</span><span style=\"color: var(--shiki-token-keyword)\">&gt;</span></span>\n<span></span>"}]}],"\n",["$","p",null,{"children":"Once the .env file is updated, restart the gateway to apply the changes."}],"\n",["$","$L7",null,{"level":2,"id":"downloading-the-parquet-file","children":"Downloading the Parquet File"}],"\n",["$","p",null,{"children":["A Parquet archive file is available for download from ",["$","$L8",null,{"href":"ar://JVmsuD2EmFkhitzWN71oi9woADE4WUfvrbBYgremCBM","children":"ar://JVmsuD2EmFkhitzWN71oi9woADE4WUfvrbBYgremCBM"}],". This file contains an unbundled data set that includes all data items uploaded via an ArDrive product, current to April 23, 2025, and compressed using tar.gz."]}],"\n",["$","p",null,{"children":"To download the file, run the following command:"}],"\n",["$","$L9",null,{"language":"bash","code":"curl -L https://arweave.net/JVmsuD2EmFkhitzWN71oi9woADE4WUfvrbBYgremCBM -o 2025-04-23-ardrive-ans104-parquet.tar.gz\n","children":["$","$La",null,{"className":"language-bash","children":"<span><span style=\"color: var(--shiki-token-function)\">curl</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">-L</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">https://arweave.net/JVmsuD2EmFkhitzWN71oi9woADE4WUfvrbBYgremCBM</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">-o</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-constant)\">2025</span><span style=\"color: var(--shiki-token-string)\">-04-23-ardrive-ans104-parquet.tar.gz</span></span>\n<span></span>"}]}],"\n",["$","p",null,{"children":["or visit the url ",["$","$L8",null,{"href":"ar://JVmsuD2EmFkhitzWN71oi9woADE4WUfvrbBYgremCBM","children":"https://arweave.net/JVmsuD2EmFkhitzWN71oi9woADE4WUfvrbBYgremCBM"}]," and download the file manually."]}],"\n",["$","div",null,{"className":"border-l-4 border-orange-500 bg-gray-800 text-white p-4 rounded-md","children":[["$","div",null,{"className":"font-semibold text-lg text-orange-300 mb-2","children":"Note"}],["$","div",null,{"className":"text-sm","children":[["$","p",null,{"language":"txt","children":["If downloaded manually, it will download as a binary file named ",["$","$La",null,{"children":"JVmsuD2EmFkhitzWN71oi9woADE4WUfvrbBYgremCBM"}],". This is normal and must be converted to a tar.gz file by renaming it to ",["$","$La",null,{"children":"2025-04-23-ardrive-ans104-parquet.tar.gz"}],"."]}],["$","p",null,{"children":"It should also be placed in the root directory of the gateway."}]]}]]}],"\n",["$","p",null,{"children":"The downloaded file will be approximately 3.5GB in size."}],"\n",["$","$L7",null,{"level":2,"id":"extracting-and-importing-the-parquet-file","children":"Extracting and Importing the Parquet File"}],"\n",["$","p",null,{"children":"With the parquet file downloaded and placed in the root directory of the gateway, you can extract the file and import it into ClickHouse."}],"\n",["$","$L9",null,{"language":"bash","code":"tar -xzf 2025-04-23-ardrive-ans104-parquet.tar.gz\n","children":["$","$La",null,{"className":"language-bash","children":"<span><span style=\"color: var(--shiki-token-function)\">tar</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">-xzf</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-constant)\">2025</span><span style=\"color: var(--shiki-token-string)\">-04-23-ardrive-ans104-parquet.tar.gz</span></span>\n<span></span>"}]}],"\n",["$","p",null,{"language":"txt","children":["This will extract the file into a directory named ",["$","$La",null,{"children":"2025-04-23-ardrive-ans104-parquet"}],", and take a while to complete."]}],"\n",["$","p",null,{"language":"txt","children":["Next, if you do not already have a ",["$","$La",null,{"children":"data/parquet"}]," directory, you must create it. Release 33 does not have this directory by default, but future Releases will. You can create the directory by using the following command:"]}],"\n",["$","$L9",null,{"language":"bash","code":"mkdir -p data/parquet\n","children":["$","$La",null,{"className":"language-bash","children":"<span><span style=\"color: var(--shiki-token-function)\">mkdir</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">-p</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">data/parquet</span></span>\n<span></span>"}]}],"\n",["$","p",null,{"children":"or by starting the gateway ClickHouse container with the following command:"}],"\n",["$","$L9",null,{"language":"bash","code":"docker compose --profile clickhouse up clickhouse -d\n","children":["$","$La",null,{"className":"language-bash","children":"<span><span style=\"color: var(--shiki-token-function)\">docker</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">compose</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">--profile</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">clickhouse</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">up</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">clickhouse</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">-d</span></span>\n<span></span>"}]}],"\n",["$","div",null,{"className":"border-l-4 border-orange-500 bg-gray-800 text-white p-4 rounded-md","children":[["$","div",null,{"className":"font-semibold text-lg text-orange-300 mb-2","children":"Note"}],["$","div",null,{"className":"text-sm","children":[["$","p",null,{"children":"Depending on your system configurations, allowing the gateway to create the directory may result in the directory being created with incorrect permissions. If this is the case, you can remove the restrictions by running the following command:"}],["$","$L9",null,{"language":"bash","code":"sudo chmod -R 777 data/parquet\n","children":["$","$La",null,{"className":"language-bash","children":"<span><span style=\"color: var(--shiki-token-function)\">sudo</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">chmod</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">-R</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-constant)\">777</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">data/parquet</span></span>\n<span></span>"}]}]]}]]}],"\n",["$","p",null,{"children":"With the directory created, you can now move the extracted parquet files into it."}],"\n",["$","$L9",null,{"language":"bash","code":"mv 2025-04-23-ardrive-ans104-parquet/* data/parquet\n","children":["$","$La",null,{"className":"language-bash","children":"<span><span style=\"color: var(--shiki-token-function)\">mv</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-constant)\">2025</span><span style=\"color: var(--shiki-token-string)\">-04-23-ardrive-ans104-parquet/*</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">data/parquet</span></span>\n<span></span>"}]}],"\n",["$","p",null,{"children":"When this is complete, you can run the import script to import the parquet files into ClickHouse."}],"\n",["$","p",null,{"children":"If you haven't done so already, start the ClickHouse container with the following command:"}],"\n",["$","$L9",null,{"language":"bash","code":"docker compose --profile clickhouse up clickhouse -d\n","children":["$","$La",null,{"className":"language-bash","children":"<span><span style=\"color: var(--shiki-token-function)\">docker</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">compose</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">--profile</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">clickhouse</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">up</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">clickhouse</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">-d</span></span>\n<span></span>"}]}],"\n",["$","p",null,{"children":"Then run the import script with the following command:"}],"\n",["$","$L9",null,{"language":"bash","code":"./scripts/clickhouse-import\n","children":["$","$La",null,{"className":"language-bash","children":"<span><span style=\"color: var(--shiki-token-function)\">./scripts/clickhouse-import</span></span>\n<span></span>"}]}],"\n",["$","p",null,{"children":"This process will take several minutes, and will output the progress of the import."}],"\n",["$","$L7",null,{"level":2,"id":"verifying-successful-import","children":"Verifying Successful Import"}],"\n",["$","p",null,{"children":"To verify that the import was successful, run the following commands:"}],"\n",["$","$L9",null,{"language":"bash","code":"clickhouse client --password <your-password> -h localhost -q 'SELECT COUNT(DISTINCT id) FROM transactions'\n","children":["$","$La",null,{"className":"language-bash","children":"$d"}]}],"\n",["$","p",null,{"language":"txt","children":["Being sure to replace ",["$","$La",null,{"children":"<your-password>"}]," with the password you set for the selected ClickHouse user."]}],"\n",["$","p",null,{"language":"txt","children":["This should return a count of the number of unique transactions in the parquet file, which is ",["$","$La",null,{"children":"32712311"}],"."]}],"\n",["$","p",null,{"language":"txt","children":["You can also verify that the data is being served by the gateway's GraphQL endpoint by ensuring the gateway is not proxying its GraphQL queries (Make sure ",["$","$La",null,{"children":"GRAPHQL_HOST"}]," is not set) and running the following command:"]}],"\n",["$","$L9",null,{"language":"bash","code":"curl -g -X POST \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"query\":\"query { transactions(ids: [\\\"YSNwoYB01EFIzbs6HmkGUjjxHW3xuqh-rckYhi0av4A\\\"]) { edges { node { block { height } bundledIn { id } } } } }\"}' \\\n  http://localhost:3000/graphql\n\n# Expected output:\n# {\"data\":{\"transactions\":{\"edges\":[{\"node\":{\"block\":{\"height\":1461918},\"bundledIn\":{\"id\":\"ylhb0PqDtG5HwBg00_RYztUl0x2RuKvbNzT6YiNR2JA\"}}}]}}}\n","children":["$","$La",null,{"className":"language-bash","children":"$e"}]}],"\n",["$","$L7",null,{"level":2,"id":"starting-and-stopping-the-gateway-with-click-house","children":"Starting and Stopping the Gateway with ClickHouse"}],"\n",["$","p",null,{"children":"The gateway ClickHouse container is run as a \"profile\" in the main docker compose file. That means you must specify the profile when starting or stopping the gateway if you want to include the ClickHouse container in the commands."}],"\n",["$","p",null,{"children":"To start the gateway with the ClickHouse profile, run the following command:"}],"\n",["$","$L9",null,{"language":"bash","code":"docker compose --profile clickhouse up -d\n","children":["$","$La",null,{"className":"language-bash","children":"<span><span style=\"color: var(--shiki-token-function)\">docker</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">compose</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">--profile</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">clickhouse</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">up</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">-d</span></span>\n<span></span>"}]}],"\n",["$","p",null,{"language":"txt","children":["This will start all of the containers normally covered by the ",["$","$La",null,{"children":"docker compose up"}]," command, but will also start the ClickHouse container."]}],"\n",["$","p",null,{"children":"To stop the gateway with the ClickHouse profile, run the following command:"}],"\n",["$","$L9",null,{"language":"bash","code":"docker compose --profile clickhouse down\n","children":["$","$La",null,{"className":"language-bash","children":"<span><span style=\"color: var(--shiki-token-function)\">docker</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">compose</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">--profile</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">clickhouse</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">down</span></span>\n<span></span>"}]}],"\n",["$","p",null,{"language":"txt","children":["This will stop all of the containers normally covered by the ",["$","$La",null,{"children":"docker compose down"}]," command, but will also stop the ClickHouse container."]}],"\n",["$","p",null,{"children":"To start or stop only the ClickHouse container, you can use the following commands:"}],"\n",["$","$L9",null,{"language":"bash","code":"docker compose --profile clickhouse up clickhouse -d\n","children":["$","$La",null,{"className":"language-bash","children":"<span><span style=\"color: var(--shiki-token-function)\">docker</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">compose</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">--profile</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">clickhouse</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">up</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">clickhouse</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">-d</span></span>\n<span></span>"}]}],"\n",["$","p",null,{"children":"and"}],"\n",["$","$L9",null,{"language":"bash","code":"docker compose --profile clickhouse down clickhouse\n","children":["$","$La",null,{"className":"language-bash","children":"<span><span style=\"color: var(--shiki-token-function)\">docker</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">compose</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">--profile</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">clickhouse</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">down</span><span style=\"color: var(--shiki-color-text)\"> </span><span style=\"color: var(--shiki-token-string)\">clickhouse</span></span>\n<span></span>"}]}]]}],["$","footer",null,{"className":"mx-auto mt-16 w-full max-w-2xl lg:max-w-5xl","children":["$","$Lf",null,{}]}]]}],null,["$","$L10",null,{"children":["$L11","$L12",["$","$L13",null,{"promise":"$@14"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],["$","$1","h",{"children":[null,["$","$1","ZXypccNAfdGaTt6xJF0oov",{"children":[["$","$L15",null,{"children":"$L16"}],null]}],["$","$L17",null,{"children":"$L18"}]]}],false]],"m":"$undefined","G":["$19","$undefined"],"s":false,"S":true}
1a:"$Sreact.suspense"
1b:I[74911,[],"AsyncMetadata"]
18:["$","div",null,{"hidden":true,"children":["$","$1a",null,{"fallback":null,"children":["$","$L1b",null,{"promise":"$@1c"}]}]}]
12:null
16:[["$","meta","0",{"charSet":"utf-8"}],["$","meta","1",{"name":"viewport","content":"width=device-width, initial-scale=1"}]]
11:null
14:{"metadata":[["$","title","0",{"children":"Parquet and ClickHouse Usage Guide - AR.IO Docs"}],["$","meta","1",{"name":"description","content":"Learn how to use Parquet files and ClickHouse to improve performance and scalability of your AR.IO gateway for large datasets."}],["$","meta","2",{"property":"og:title","content":"Parquet and ClickHouse Usage Guide"}],["$","meta","3",{"property":"og:description","content":"Learn how to use Parquet files and ClickHouse to improve performance and scalability of your AR.IO gateway for large datasets."}],["$","meta","4",{"name":"twitter:card","content":"summary"}],["$","meta","5",{"name":"twitter:title","content":"Parquet and ClickHouse Usage Guide"}],["$","meta","6",{"name":"twitter:description","content":"Learn how to use Parquet files and ClickHouse to improve performance and scalability of your AR.IO gateway for large datasets."}],["$","link","7",{"rel":"icon","href":"/docs-v2/favicon.ico","type":"image/x-icon","sizes":"16x16"}]],"error":null,"digest":"$undefined"}
1c:{"metadata":"$14:metadata","error":null,"digest":"$undefined"}
