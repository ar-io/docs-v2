---
title: "Grafana"
description: "Comprehensive guide to deploying and configuring Grafana for AR.IO Gateway monitoring and analytics"
---

import { Steps, Step } from "fumadocs-ui/components/steps";
import { Callout } from "fumadocs-ui/components/callout";
import { Cards, Card } from "fumadocs-ui/components/card";
import { Accordion, Accordions } from "fumadocs-ui/components/accordion";
import { BarChart3, Database, Package, Cpu } from "lucide-react";

## Overview

AR.IO gateways track extensive performance and operational metrics using [Prometheus](https://prometheus.io/). A [Grafana](https://grafana.com/) sidecar can be deployed to visualize these metrics, providing an easy way to monitor gateway health and performance.

The Grafana sidecar is deployed as a separate Docker container that uses the same network as the gateway, making it simple to integrate with your existing setup.

![Grafana Dashboard](/grafana.png)

## Quick Start

<Steps>
<Step>
### Deploy Grafana

Deploy the Grafana sidecar using the provided Docker Compose file:

```bash
docker compose -f docker-compose.grafana.yaml up -d
```

<Callout type="info" title="Terminal Location">
  This command assumes you're running from the root directory of the gateway. If
  running from a different directory, adjust the path to the docker-compose file
  accordingly.
</Callout>

</Step>

<Step>
### Verify Deployment

Check that Grafana is running properly:

```bash
docker compose -f docker-compose.grafana.yaml logs -f --tail=25
```

Press `Ctrl+C` to exit the logs. Look for any error messages or permission issues.

</Step>

<Step>
### Access Grafana

Navigate to `http://localhost:1024` in your browser to access Grafana.

**Default credentials:**

- Username: `admin`
- Password: `admin`

<Callout type="warning" title="Credential Reset">
  Updated credentials may be lost if the Grafana sidecar is restarted. Be sure
  to log into Grafana immediately after every startup to ensure Grafana cannot
  be accessed with the default credentials.
</Callout>

</Step>
</Steps>

## Exposing Dashboard Publicly

To expose your Grafana dashboard externally through your domain, you'll need to configure nginx as a reverse proxy. This requires DNS setup and SSL certificates as covered in the [gateway installation guide](/build/run-a-gateway/quick-start).

<Callout type="info" title="Prerequisites">
  This setup assumes you've already configured DNS, SSL certificates, and nginx
  as described in the [Installation & Setup
  guide](/build/run-a-gateway/quick-start).
</Callout>

<Steps>
<Step>
### Deploy Grafana Sidecar

First, ensure your Grafana container is running:

```bash
docker compose -f docker-compose.grafana.yaml up -d
```

Verify it's accessible locally at `http://localhost:1024`.

</Step>

<Step>
### Update Nginx Configuration

Edit your existing nginx configuration file (`/etc/nginx/sites-available/default`) to add the Grafana location block:

```nginx
# Add this block inside your existing HTTPS server block (port 443)
location /grafana/ {
    proxy_pass http://localhost:1024/grafana/;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
}
```

Your complete nginx configuration should look like this:

```nginx
# Force redirects from HTTP to HTTPS
server {
    listen 80;
    listen [::]:80;
    server_name <your-domain>.com *.<your-domain>.com;

    location / {
        return 301 https://$host$request_uri;
    }
}

# Forward traffic to your node and provide SSL certificates
server {
    listen 443 ssl;
    listen [::]:443 ssl;
    server_name <your-domain>.com *.<your-domain>.com;

    ssl_certificate /etc/letsencrypt/live/<your-domain>.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/<your-domain>.com/privkey.pem;

    location / {
        proxy_pass http://localhost:3000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_http_version 1.1;

        # Forward AR.IO headers if present in the request
        proxy_set_header X-AR-IO-Origin $http_x_ar_io_origin;
        proxy_set_header X-AR-IO-Origin-Node-Release $http_x_ar_io_origin_node_release;
        proxy_set_header X-AR-IO-Hops $http_x_ar_io_hops;
    }

    # Grafana dashboard access
    location /grafana/ {
        proxy_pass http://localhost:1024/grafana/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

</Step>

<Step>
### Test and Reload Nginx

Validate your nginx configuration:

```bash
sudo nginx -t
```

If the configuration is valid, reload nginx:

```bash
sudo systemctl reload nginx
```

</Step>

<Step>
### Access Your Dashboard

Navigate to `https://<your-domain>.com/grafana/` in your browser to access your Grafana dashboard externally.

**Default credentials:**

- Username: `admin`
- Password: `admin`

</Step>
</Steps>

## Troubleshooting

<Accordions>
<Accordion title="Permission Errors">

### Fix Permission Issues

<Steps>
<Step>
### Method 1: Modify Directory Permissions

The simplest solution is to modify the permissions of the Grafana data directory:

```bash
sudo chmod -R 777 ./data/grafana
```

<Callout type="info" title="Terminal Location">
  This command assumes you're running from the root directory of the gateway.
  Adjust the path if running from a different directory.
</Callout>

</Step>

<Step>
### Method 2: Change Grafana User

Alternatively, modify the `docker-compose.grafana.yaml` file to use root user:

```yaml
grafana:
  image: grafana/grafana:latest
  user: root
  ports:
    - "3000:3000"
```

</Step>

<Step>
### Verify Fix

Restart Grafana and check logs:

```bash
docker compose -f docker-compose.grafana.yaml restart
docker compose -f docker-compose.grafana.yaml logs -f
```

</Step>
</Steps>

</Accordion>

<Accordion title="Connection Issues">

### Resolve Connection Problems

<Steps>
<Step>
### Check Container Status

Verify Grafana is running:

```bash
docker compose -f docker-compose.grafana.yaml ps
```

</Step>

<Step>
### Check Port Availability

Ensure the port isn't already in use:

```bash
netstat -tulpn | grep :1024
# or
lsof -i :1024
```

</Step>

<Step>
### Review Logs

Check for specific error messages:

```bash
docker compose -f docker-compose.grafana.yaml logs --tail=50
```

</Step>
</Steps>

</Accordion>

<Accordion title="Configuration Problems">

### Fix Configuration Issues

<Steps>
<Step>
### Validate Nginx Configuration

Test your Nginx configuration:

```bash
sudo nginx -t
```

</Step>

<Step>
### Check Proxy Settings

Ensure proxy headers are correctly configured:

```nginx
location /grafana/ {
    proxy_pass http://localhost:1024/grafana/;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
}
```

</Step>

<Step>
### Restart Services

Restart both Nginx and Grafana:

```bash
sudo systemctl restart nginx
docker compose -f docker-compose.grafana.yaml restart
```

</Step>
</Steps>

</Accordion>
</Accordions>

## Security Considerations

<Callout type="warning" title="Default Credentials">
  Always change the default admin credentials immediately after first login.
  Default credentials are publicly known and pose a security risk.
</Callout>

### Best Practices

1. **Change Default Password** - Use a strong, unique password
2. **Enable HTTPS** - Use SSL certificates for external access
3. **Restrict Access** - Use firewall rules to limit access
4. **Regular Updates** - Keep Grafana updated to latest version
5. **Backup Configuration** - Export and backup dashboard configurations

## Documentation & Support

- **Grafana Documentation** - [Official Grafana docs](https://grafana.com/docs/)
- **Prometheus Metrics** - [Understanding gateway metrics](https://prometheus.io/docs/concepts/metric_types/)
- **Community Support** - Join the [AR.IO Discord](https://discord.gg/cuCqBb5v) for help

## Useful Docker Commands

Monitor and manage your Grafana sidecar with these commands:

```bash
# View all running services
docker ps

# Start Grafana sidecar
docker compose -f docker-compose.grafana.yaml up -d

# Stop Grafana sidecar
docker compose -f docker-compose.grafana.yaml down

# Pull latest Grafana images
docker compose -f docker-compose.grafana.yaml pull

# Follow Grafana logs
docker compose -f docker-compose.grafana.yaml logs -f --tail=25

# Check Grafana container status
docker compose -f docker-compose.grafana.yaml ps

# Restart Grafana sidecar
docker compose -f docker-compose.grafana.yaml restart

# View Grafana logs without following
docker compose -f docker-compose.grafana.yaml logs --tail=50

# Start Grafana in foreground (for debugging)
docker compose -f docker-compose.grafana.yaml up

# Check port availability
netstat -tulpn | grep :1024
```

## Next Steps

Now that you have monitoring set up, continue building your gateway infrastructure:

<Cards>
  <Card
    icon={<BarChart3 className="w-8 h-8" />}
    title="Optimize Performance"
    description="Learn advanced gateway optimization techniques for better performance"
    href="/build/run-a-gateway/manage/filters"
  />
  <Card
    icon={<Database className="w-8 h-8" />}
    title="Add ClickHouse"
    description="Improve query performance with ClickHouse and Parquet integration"
    href="/build/extensions/clickhouse"
  />
  <Card
    icon={<Package className="w-8 h-8" />}
    title="Deploy Bundler"
    description="Accept data uploads directly through your gateway"
    href="/build/extensions/bundler"
  />
  <Card
    icon={<Cpu className="w-8 h-8" />}
    title="Run Compute Unit"
    description="Execute AO processes locally for maximum efficiency"
    href="/build/extensions/compute-unit"
  />
</Cards>
