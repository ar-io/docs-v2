import { CodeGroup } from '@/components/Code'

export const metadata = {
  title: 'buyRecord (manual)',
  description:
    'Purchase an ArNS record for a specified name and duration with manual ANT creation',
  openGraph: {
    title: 'buyRecord (manual)',
  },
}

# buyRecord

`buyRecord` is a method on the `ARIO` class that purchases a record in the ArNS registry for a specified name and duration.

`buyRecord` requires authentication.

<Tip title="Important: ANT Process ID">
  The `processId` parameter must be the process ID of an **ANT (Arweave Name
  Token)** that you own or control. You cannot use the ARIO contract address or
  create ANTs automatically through this method. **You must create your ANT
  separately before calling `buyRecord`.**
</Tip>

## Parameters

{

<div style={{ textAlign: 'center' }}>
  <table className="inline-table">
    <thead>
      <tr>
        <th>Parameter</th>
        <th>Type</th>
        <th>Description</th>
        <th>Optional</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <th>name</th>
        <td>string</td>
        <td>The ArNS name to purchase</td>
        <td>false</td>
      </tr>
      <tr>
        <th>years</th>
        <td>number</td>
        <td>The number of years to lease the name for (1-5)</td>
        <td>false</td>
      </tr>
      <tr>
        <th>processId</th>
        <td>string</td>
        <td>
          The ANT process ID to set for this name. Must be an existing ANT that
          you own or control
        </td>
        <td>false</td>
      </tr>
      <tr>
        <th>type</th>
        <td>string</td>
        <td>The type of purchase: 'lease' or 'permabuy'</td>
        <td>true</td>
      </tr>
      <tr>
        <th>fundFrom</th>
        <td>string</td>
        <td>The source of funds: 'balance', 'stakes', 'any', or 'turbo'</td>
        <td>true</td>
      </tr>
      <tr>
        <th>paidBy</th>
        <td>string | string[]</td>
        <td>
          Wallet address(es) that will pay for the purchase (used with fundFrom:
          'turbo')
        </td>
        <td>true</td>
      </tr>
      <tr>
        <th>tags</th>
        <td>array</td>
        <td>
          An array of GQL tag objects to attach to the transfer AO message
        </td>
        <td>true</td>
      </tr>
    </tbody>
  </table>
</div>
}

## Examples

<CodeGroup title="buyRecord">

    ```typescript {{title: "Complete Workflow - NodeJS"}}
    const fs = require("fs");
    const {
      ARIO,
      ANT,
      ANTRegistry,
      ArweaveSigner,
      spawnANT,
      createAoSigner,
      initANTStateForAddress
    } = require("@ar.io/sdk");

    async function main() {
        const jwk = JSON.parse(fs.readFileSync("KeyFile.json"));
        const signer = new ArweaveSigner(jwk);
        const aoSigner = createAoSigner(signer);

        // Get latest ANT version
        const antVersions = ANT.versions.init();
        const latestVersion = await antVersions.getLatestANTVersion();

        // Spawn ANT process
        const antState = initANTStateForAddress({
            owner: signer.address,
            name: 'My Awesome Domain',
            ticker: 'MAD',
            description: 'My awesome ArNS domain'
        });

        const antProcessId = await spawnANT({
            signer: aoSigner,
            module: latestVersion.moduleId,
            state: antState
        });

        // Configure ANT
        const ant = ANT.init({
            signer,
            processId: antProcessId
        });

        await ant.setName({ name: 'My Awesome Domain' });
        await ant.setTicker({ ticker: 'MAD' });

        // Register ANT with registry
        const antRegistry = ANTRegistry.init({ signer });
        await antRegistry.register({ processId: antProcessId });

        // Wait for registration to be processed
        let isRegistered = false;
        let attempts = 0;
        while (!isRegistered && attempts < 15) {
            await new Promise(resolve => setTimeout(resolve, 2000 * (attempts + 1)));
            try {
                const acl = await antRegistry.accessControlList({ address: signer.address });
                isRegistered = [...acl.Owned, ...acl.Controlled].includes(antProcessId);
                attempts++;
            } catch (error) {
                attempts++;
            }
        }

        if (!isRegistered) {
            throw new Error('Failed to register ANT after multiple attempts');
        }

        // Purchase ArNS name
        const ario = ARIO.init({ signer });
        const { id: txId } = await ario.buyRecord({
            name: 'mydomain',
            years: 1,
            processId: antProcessId,
            type: 'lease',
            fundFrom: 'balance'
        });

        console.log('ArNS name purchased successfully!');
        console.log('Transaction ID:', txId);
        console.log('ANT Process ID:', antProcessId);
    }

    main().catch(console.error);
    ```

    ```typescript {{ title: 'Complete Workflow - Web' }}
    import {
      ARIO,
      ANT,
      ANTRegistry,
      ArConnectSigner,
      spawnANT,
      createAoSigner,
      initANTStateForAddress
    } from '@ar.io/sdk/web';

    async function main() {
        // Connect wallet
        await window.arweaveWallet.connect([
          'ACCESS_ADDRESS',
          'ACCESS_ALL_ADDRESSES',
          'ACCESS_PUBLIC_KEY',
          'SIGN_TRANSACTION',
          'ACCESS_ARWEAVE_CONFIG',
          'SIGNATURE',
        ]);
        const signer = new ArConnectSigner(window.arweaveWallet);
        const aoSigner = createAoSigner(signer);

        // Get latest ANT version
        const antVersions = ANT.versions.init();
        const latestVersion = await antVersions.getLatestANTVersion();

        // Spawn ANT process
        const antState = initANTStateForAddress({
            owner: signer.address,
            name: 'My Awesome Domain',
            ticker: 'MAD',
            description: 'My awesome ArNS domain'
        });

        const antProcessId = await spawnANT({
            signer: aoSigner,
            module: latestVersion.moduleId,
            state: antState
        });

        // Configure ANT
        const ant = ANT.init({
            signer,
            processId: antProcessId
        });

        await ant.setName({ name: 'My Awesome Domain' });
        await ant.setTicker({ ticker: 'MAD' });

        // Register ANT with registry
        const antRegistry = ANTRegistry.init({ signer });
        await antRegistry.register({ processId: antProcessId });

        // Wait for registration to be processed
        let isRegistered = false;
        let attempts = 0;
        while (!isRegistered && attempts < 15) {
            await new Promise(resolve => setTimeout(resolve, 2000 * (attempts + 1)));
            try {
                const acl = await antRegistry.accessControlList({ address: signer.address });
                isRegistered = [...acl.Owned, ...acl.Controlled].includes(antProcessId);
                attempts++;
            } catch (error) {
                attempts++;
            }
        }

        if (!isRegistered) {
            throw new Error('Failed to register ANT after multiple attempts');
        }

        // Purchase ArNS name
        const ario = ARIO.init({ signer });
        const { id: txId } = await ario.buyRecord({
            name: 'mydomain',
            years: 1,
            processId: antProcessId,
            type: 'lease',
            fundFrom: 'balance'
        });

        console.log('ArNS name purchased successfully!');
        console.log('Transaction ID:', txId);
        console.log('ANT Process ID:', antProcessId);
    }

    main().catch(console.error);
    ```

    ```typescript {{ title: 'Using Existing ANT' }}
    import { ARIO, ArConnectSigner } from '@ar.io/sdk/web';

    async function main() {
        // Connect wallet
        await window.arweaveWallet.connect([
            'ACCESS_ADDRESS',
            'ACCESS_ALL_ADDRESSES',
            'ACCESS_PUBLIC_KEY',
            'SIGN_TRANSACTION',
            'ACCESS_ARWEAVE_CONFIG',
            'SIGNATURE',
          ]);
        const signer = new ArConnectSigner(window.arweaveWallet);
        const existingAntProcessId = 'your-existing-ant-process-id';

        const ario = ARIO.init({ signer });
        const { id: txId } = await ario.buyRecord({
            name: 'mydomain',
            years: 1,
            processId: existingAntProcessId,
            type: 'lease'
        });

        console.log('ArNS name purchased successfully!');
        console.log('Transaction ID:', txId);
        console.log('ANT Process ID:', existingAntProcessId);
    }

    main().catch(console.error);
    ```

</CodeGroup>
